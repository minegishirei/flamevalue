import{GtmSupport as v,loadScript as m}from"@gtm-support/core";import{nextTick as O}from"vue";import{GtmSupport as k,assertIsGtmId as L,hasScript as S,loadScript as U}from"@gtm-support/core";var t;function G(i,e={id:""}){e={trackOnNextTick:!1,...e},t=new v(e),i.config.globalProperties.$gtm=t,t.isInBrowserContext()&&(e.vueRouter&&A(i,e.vueRouter,e.ignoredViews,e.trackOnNextTick,e.vueRouterAdditionalEventData),t.options.enabled&&t.options.loadScript&&(Array.isArray(e.id)?e.id.forEach(a=>{if(typeof a=="string")m(a,e);else{let o={...e};a.queryParams!=null&&(o.queryParams={...o.queryParams,...a.queryParams}),m(a.id,o)}}):m(e.id,e))),i.provide("gtm",e)}function A(i,e,a=[],o,g=()=>({})){function p(r,u){return r instanceof Error?!!(r.type&u):!1}e.afterEach(async(r,u,d)=>{var c,f,y;if(typeof r.name!="string"||Array.isArray(a)&&a.includes(r.name)||typeof a=="function"&&a(r,u))return;let s=r.meta&&typeof r.meta.gtm=="string"&&r.meta.gtm?r.meta.gtm:r.name;p(d,4)?t!=null&&t.debugEnabled()&&console.log(`[VueGtm]: '${s}' not tracked due to navigation aborted`):p(d,8)&&t!=null&&t.debugEnabled()&&console.log(`[VueGtm]: '${s}' not tracked due to navigation cancelled`);let l={...await g(r,u),...(c=r.meta)==null?void 0:c.gtmAdditionalEventData},n=((y=(f=e.options)==null?void 0:f.history)==null?void 0:y.base)??"";n.endsWith("/")||(n+="/"),n+=r.fullPath.startsWith("/")?r.fullPath.substring(1):r.fullPath,o?O(()=>{t==null||t.trackView(s,n,l)}):t==null||t.trackView(s,n,l)})}function x(i){return{install:e=>G(e,i)}}var N={install:G};var T=N;function P(){return t}export{v as GtmPlugin,k as GtmSupport,L as assertIsGtmId,x as createGtm,T as default,S as hasScript,U as loadScript,P as useGtm};
//# sourceMappingURL=index.js.map